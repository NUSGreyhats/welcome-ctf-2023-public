

# This file was *autogenerated* from the file sol.sage
from sage.all_cmdline import *   # import sage library

_sage_const_9999 = Integer(9999); _sage_const_320 = Integer(320); _sage_const_1 = Integer(1); _sage_const_2 = Integer(2)
from pwn import *
from hashlib import shake_256

def decrypt(s, c):
    key = shake_256(str(s).encode()).digest(len(c))
    return bytes([i ^ j for i, j in zip(key, c)])

r = remote("localhost", _sage_const_9999 )

p = factorial(_sage_const_320 ) + _sage_const_1 

r.sendline(str(p))
r.sendline(str(_sage_const_2 ))

r.recvuntil("output: ")
A = int(r.recvline().decode())

r.recvuntil("c: ")
c = bytes.fromhex(r.recvline().decode())

s = discrete_log(GF(p)(A), GF(p)(_sage_const_2 ))

print(decrypt(int(s), c))

